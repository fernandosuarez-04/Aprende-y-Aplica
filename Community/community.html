<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=1280, initial-scale=0.6, maximum-scale=0.6, user-scalable=yes">
    <meta name="supabase-url" content="https://miwbzotcuaywpdbidpwo.supabase.co">
    <meta name="supabase-key" content="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1pd2J6b3RjdWF5d3BkYmlkcHdvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ2MTEyMjksImV4cCI6MjA3MDE4NzIyOX0.IKXYAe1JBFc_pcaS6OjxKUVJePwnfHgc0sRO6WpJSBY">
    <title>Comunidad</title>
    <link rel="stylesheet" href="/Community/community.css">
    <link rel="icon" type="image/x-icon" href="/assets/images/icono.png">

    <!-- Estilos para modal de solicitud de acceso -->
    <style>
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(4px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            background: var(--background);
            border-radius: 12px;
            padding: 24px;
            max-width: 480px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: slideUp 0.3s ease;
            border: 1px solid var(--border-color);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border-color);
        }

        .modal-header h2 {
            margin: 0;
            color: var(--text-primary);
            font-size: 1.4rem;
            font-weight: 600;
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 1.2rem;
            cursor: pointer;
            padding: 8px;
            border-radius: 6px;
            transition: all 0.2s ease;
        }

        .modal-close:hover {
            background: var(--surface);
            color: var(--text-primary);
        }

        .modal-body {
            margin-bottom: 24px;
            color: var(--text-primary);
            line-height: 1.6;
        }

        .modal-footer {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }

        .btn-primary, .btn-secondary {
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
            font-size: 0.9rem;
        }

        .btn-primary {
            background: var(--accent-color);
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: var(--accent-hover);
            transform: translateY(-1px);
        }

        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .btn-secondary {
            background: var(--surface);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: var(--background);
            border-color: var(--accent-color);
        }

        .request-status {
            padding: 12px 16px;
            border-radius: 8px;
            font-weight: 500;
            margin-bottom: 16px;
        }

        .request-status.pending {
            background: rgba(255, 193, 7, 0.1);
            color: #ffc107;
            border: 1px solid rgba(255, 193, 7, 0.3);
        }

        .request-status.rejected {
            background: rgba(220, 53, 69, 0.1);
            color: #dc3545;
            border: 1px solid rgba(220, 53, 69, 0.3);
        }

        .access-status.pending {
            color: #ffc107;
            font-weight: 500;
        }

        .access-status.rejected {
            color: #dc3545;
            font-weight: 500;
        }

        .access-status.invite-only {
            color: #6f42c1;
            font-weight: 500;
        }

        .access-status.login-required {
            color: #007bff;
            font-weight: 500;
            cursor: pointer;
        }

        .access-status.login-required:hover {
            color: #0056b3;
            text-decoration: underline;
        }

        .access-status.member {
            color: #28a745;
            font-weight: 500;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from {
                transform: translateY(30px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .community-banner-actions {
            margin-left: auto;
            display: flex;
            gap: 12px;
        }

        .community-banner-content {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        /* Estilos para botón de unirse a comunidad */
        .discover-actions {
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid var(--border-color);
        }

        .join-community-btn {
            background: linear-gradient(135deg, var(--accent-color), #4a90e2);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 10px 16px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0, 123, 255, 0.2);
            width: 100%;
            text-align: center;
        }

        .join-community-btn:hover:not(:disabled) {
            background: linear-gradient(135deg, #4a90e2, var(--accent-color));
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0, 123, 255, 0.3);
        }

        .join-community-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: 0 2px 8px rgba(0, 123, 255, 0.1);
        }

        .join-community-btn:active:not(:disabled) {
            transform: translateY(0);
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- BoxIcons - iconografía principal -->
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>

    <!-- Navbar Global CSS - Sistema unificado con máxima prioridad -->
    <link rel="stylesheet" href="/styles/navbar-global.css">

    <!-- Global theme setup - Configuración global del tema -->
    <script src="/scripts/global-theme-setup.js"></script>
    
    <!-- Auth Guard - Protección de autenticación -->
    <script src="/utils/auth-guard.js"></script>
</head>
<body class="bg-glow-global">
    <!-- Contenedor principal con fondo limpio -->
    <div class="auth-container">
        <div class="auth-bg">
            <div class="bg-glow"></div>
        </div>


    <!-- Navigation Bar - Sistema Global -->
    <div id="navbar-container"></div>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Hero Section -->
        <section class="hero-section">
            <div class="hero-container">
                <div class="hero-content">
                    <h1 class="hero-title">Comunidad de Aprende y Aplica</h1>
                    <p class="hero-subtitle">Conecta con otros estudiantes, comparte conocimientos y participa en discusiones sobre inteligencia artificial y tecnología educativa</p>
                    <div class="hero-stats">
                        <div class="stat-item">
                            <span class="stat-number" id="totalMembers">0</span>
                            <span class="stat-label">Miembros</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number" id="totalPosts">0</span>
                            <span class="stat-label">Publicaciones</span>
                        </div>
                    </div>
                </div>
                                 <div class="hero-image">
                     <div class="hero-graphic">
                         <img src="/assets/images/icono.png" alt="Icono" class="hero-icon">
                     </div>
                 </div>
            </div>
        </section>

        <!-- (Se remueven salas de chat para adoptar flujo tipo Skool) -->

        <!-- Descubrir (tipo Skool) -->
        <section class="discover-section">
            <div class="container">
                <div class="discover-search">
                    <i class="bx bx-search"></i>
                    <input id="discoverSearch" class="discover-input" type="text" placeholder="Buscar comunidades o contenido...">
                    <button id="discoverClear" class="discover-clear" title="Limpiar" style="display:none"><i class="bx bx-x"></i></button>
                </div>
                <div class="discover-filters" id="discoverFilters">
                    <button class="discover-chip active" data-category="all">Todos</button>
                    <button class="discover-chip" data-category="general">General</button>
                    <button class="discover-chip" data-category="ia">IA</button>
                    <button class="discover-chip" data-category="datos">Datos</button>
                    <button class="discover-chip" data-category="desarrollo">Desarrollo</button>
                    <button class="discover-chip" data-category="diseno">Diseño</button>
                    <button class="discover-chip" data-category="it">IT & Software</button>
                    <button class="discover-chip" data-category="marketing">Marketing</button>
                    <button class="discover-chip" data-category="negocios">Negocios</button>
                </div>
                <div class="discover-grid" id="discoverGrid"></div>
            </div>
        </section>

        <!-- Guidelines Button -->
        <section class="guidelines-button-section">
            <div class="container">
                <button id="openGuidelinesBtn" class="guidelines-button">
                    <i class='bx bx-info-circle'></i>
                    <span>Ver Normas de la Comunidad</span>
                </button>
            </div>
        </section>

        <!-- (Se elimina feed de comunidad a petición: sólo Descubrir + Normas) -->
    </main>
    </div> <!-- Cierre del auth-container -->

    <!-- (Se elimina modal de chat) -->

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <p>Cargando comunidad...</p>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Modal de solicitud de acceso (se inyecta dinámicamente) -->

    <!-- Guidelines Modal -->
    <div id="guidelinesModal" class="guidelines-modal">
        <div class="guidelines-modal-overlay"></div>
        <div class="guidelines-modal-content">
            <div class="guidelines-modal-header">
                <h2 class="guidelines-modal-title">
                    <i class='bx bx-shield-check'></i>
                    Normas de la Comunidad
                </h2>
                <button id="closeGuidelinesBtn" class="guidelines-modal-close">
                    <i class='bx bx-x'></i>
                </button>
            </div>
            <div class="guidelines-modal-body">
                <p class="guidelines-modal-subtitle">Ayúdanos a mantener un ambiente respetuoso y constructivo</p>
                <div class="guidelines-modal-grid">
                    <div class="guideline-modal-card">
                        <div class="guideline-modal-icon">
                            <i class='bx bx-heart'></i>
                        </div>
                        <h3 class="guideline-modal-title">Sé Respetuoso</h3>
                        <p class="guideline-modal-description">Trata a todos los miembros con respeto y cortesía. No toleramos el acoso o la discriminación.</p>
                    </div>
                    <div class="guideline-modal-card">
                        <div class="guideline-modal-icon">
                            <i class='bx bx-book-open'></i>
                        </div>
                        <h3 class="guideline-modal-title">Comparte Conocimiento</h3>
                        <p class="guideline-modal-description">Contribuye con información útil y constructiva. Ayuda a otros a aprender y crecer.</p>
                    </div>
                    <div class="guideline-modal-card">
                        <div class="guideline-modal-icon">
                            <i class='bx bx-lock-alt'></i>
                        </div>
                        <h3 class="guideline-modal-title">Mantén la Privacidad</h3>
                        <p class="guideline-modal-description">No compartas información personal de otros miembros sin su consentimiento.</p>
                    </div>
                    <div class="guideline-modal-card">
                        <div class="guideline-modal-icon">
                            <i class='bx bx-flag'></i>
                        </div>
                        <h3 class="guideline-modal-title">Reporta Problemas</h3>
                        <p class="guideline-modal-description">Si ves contenido inapropiado, repórtalo inmediatamente a los moderadores.</p>
                    </div>
                    <div class="guideline-modal-card">
                        <div class="guideline-modal-icon">
                            <i class='bx bx-message-dots'></i>
                        </div>
                        <h3 class="guideline-modal-title">Comunica con Claridad</h3>
                        <p class="guideline-modal-description">Expresa tus ideas de manera clara y constructiva. Evita el spam y mensajes irrelevantes.</p>
                    </div>
                    <div class="guideline-modal-card">
                        <div class="guideline-modal-icon">
                            <i class='bx bx-group'></i>
                        </div>
                        <h3 class="guideline-modal-title">Fomenta la Colaboración</h3>
                        <p class="guideline-modal-description">Anima a otros a participar y colaborar. Construye una comunidad inclusiva y acogedora.</p>
                    </div>
                    <div class="guideline-modal-card">
                        <div class="guideline-modal-icon">
                            <i class='bx bx-brain'></i>
                        </div>
                        <h3 class="guideline-modal-title">Aprende Continuamente</h3>
                        <p class="guideline-modal-description">Mantén una mente abierta y dispuesta a aprender de otros. Comparte recursos educativos.</p>
                    </div>
                    <div class="guideline-modal-card">
                        <div class="guideline-modal-icon">
                            <i class='bx bx-time'></i>
                        </div>
                        <h3 class="guideline-modal-title">Sé Puntual</h3>
                        <p class="guideline-modal-description">Respeta los horarios de las sesiones y eventos. Valora el tiempo de los demás.</p>
                    </div>
                </div>
            </div>
            <div class="guidelines-modal-footer">
                <button id="closeGuidelinesBtnFooter" class="guidelines-modal-btn">
                    <i class='bx bx-check'></i>
                    Entendido
                </button>
            </div>
        </div>
    </div>

    <script src="/scripts/main.js"></script>
    <script src="/scripts/supabase-client.js"></script>

    <!-- Auth Utils - Sistema unificado de autenticación -->
    <script src="/utils/auth-utils.js"></script>

    <!-- Community Auth - Sistema robusto de autenticación para comunidades -->
    <script src="/Community/community-auth.js"></script>

    <script src="/scripts/community-database.js"></script>

    <!-- VERIFICACIÓN DE DEPENDENCIAS CRÍTICAS -->
    <script>
    console.log('🔍 Verificando dependencias críticas...');

    // Verificar que main.js no tenga errores
    try {
        console.log('✅ main.js se ejecutó sin errores de sintaxis');
    } catch (error) {
        console.error('❌ Error en main.js:', error);
    }

    // NUEVO: Verificar que CommunityDatabase esté disponible
    setTimeout(() => {
        console.log('🔍 Estado de dependencias después de carga:');
        console.log('📊 window.supabase:', window.supabase ? 'Disponible' : 'No disponible');
        console.log('📊 window.supabaseInitialized:', window.supabaseInitialized);
        console.log('📊 window.CommunityDatabase:', typeof window.CommunityDatabase);

        if (typeof window.CommunityDatabase === 'function') {
            console.log('✅ CommunityDatabase está disponible');
        } else {
            console.error('❌ CommunityDatabase NO está disponible');
            console.error('🔍 Verificar que community-database.js se cargue correctamente');
        }

        if (window.supabase && typeof window.supabase.createClient === 'function') {
            console.log('✅ Supabase está disponible para community.js');
        } else {
            console.error('❌ Supabase NO está disponible para community.js');
        }
    }, 1000);
    </script>

    <script src="/scripts/profile-avatar-manager.js"></script>
    <script src="/Community/community.js"></script>
    <script src="/scripts/force-theme-init.js"></script>
    <script src="/scripts/theme-manager.js"></script>

    <!-- Navbar Global - Sistema unificado -->
    <script src="/scripts/navbar-global.js"></script>
    <script>
        // Inicializar navbar global para Community
        document.addEventListener('DOMContentLoaded', function() {
            NavbarGlobal.init('comunidad', 'community');
        });
    </script>
</body>
</html>





